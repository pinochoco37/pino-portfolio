<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>QRコード生成（オフライン可）</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    .qrwrap{display:flex;gap:20px;align-items:flex-start;flex-wrap:wrap}
    #qrcode{padding:12px;border:1px solid var(--border);background:#fff;border-radius:12px}
    input[type=text]{width:560px;max-width:100%;padding:12px;border-radius:8px;border:1px solid var(--border);background:#111725;color:#e8ecf4}
    .small{font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
<div class="container">
  <h1 class="title">QRコード生成</h1>
  <p class="tagline">公開URLを入力して、PNGを保存してください（完全オフラインで動作します）。</p>
  <div class="qrwrap">
    <div>
      <input id="url" type="text" placeholder="https://example.com" value="https://example.com">
      <div class="cta">
        <button class="button primary" id="make">生成</button>
        <button class="button" id="download">PNGを保存</button>
      </div>
      <p class="small">※印刷用途では濃い目の色で出力してください。名刺サイズでも読み取りやすい濃度が推奨です。</p>
    </div>
    <div id="qrcode"></div>
  </div>
  <hr>
  <p class="note">使い方：<code>index.html</code>を公開（GitHub Pages/Netlify等）→ そのURLを上の欄に貼付 → 「生成」 → 「PNGを保存」。</p>
</div>
<script>
/*! qrcodejs v1.0 MIT */!function(o){function t(o){this.mode=s.MODE_8BIT_BYTE,this.data=o}function e(o,t){this.typeNumber=o,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function n(o,t){if(void 0==o.length)throw new Error(o.length+"/"+t);for(var e=0;e<o.length&&0==o[e];)e++;this.num=o.length-e;for(var n=new Array(this.num),r=0;r<this.num;r++)n[r]=o[r+e];this.buf=n}function r(o,t){this.totalCount=o,this.dataCount=t}function i(){this.buffer=[],this.length=0}function u(){return"undefined"!=typeof CanvasRenderingContext2D}function f(){var o=!1,t=navigator.userAgent;return"string"==typeof t&&t.indexOf("Android")>=0&&(o=/Android\s2\.[12]/.test(t)),o}var s={};t.prototype={getLength:function(o){return this.data.length},write:function(o){for(var t=0;t<this.data.length;t++)o.put(this.data.charCodeAt(t),8)}},e.prototype={addData:function(o){var e=new t(o);this.dataList.push(e),this.dataCache=null},isDark:function(o,t){if(null==this.modules)throw new Error("modules is null");return this.modules[o][t]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(o,t){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var e=0;e<this.moduleCount;e++){this.modules[e]=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++)this.modules[e][n]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(o,t),this.typeNumber>=7&&this.setupTypeNumber(o),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,t)},setupPositionProbePattern:function(o,t){for(var e=-1;e<=7;e++)if(!(o+e<=-1||this.moduleCount<=o+e))for(var n=-1;n<=7;n++)t+n<=-1||this.moduleCount<=t+n||(this.modules[o+e][t+n]=e>=0&&e<=6&&(0==n||6==n)||n>=0&&n<=6&&(0==e||6==e)||e>=2&&e<=4&&n>=2&&n<=4)},getBestMaskPattern:function(){for(var o=0,t=0,e=0;e<8;e++){this.makeImpl(!0,e);var n=s.Util.getLostPoint(this);(0==e||n<o)&&(o=n,t=e)}return t},createMovieClip:function(o,t,e){var n=o.createEmptyMovieClip(t,e);this.make();for(var r=1,i=0;i<this.modules.length;i++)for(var u=0;u<this.modules[i].length;u++){var f=1;this.modules[i][u]&&(n.beginFill(0,100),n.moveTo(u*r,i*r),n.lineTo((u+1)*r,i*r),n.lineTo((u+1)*r,(i+1)*r),n.lineTo(u*r,(i+1)*r),n.endFill())}return n},setupTimingPattern:function(){for(var o=8;o<this.moduleCount-8;o++)null==this.modules[o][6]&&(this.modules[o][6]=o%2==0),null==this.modules[6][o]&&(this.modules[6][o]=o%2==0)},setupPositionAdjustPattern:function(){for(var o=s.Util.getPatternPosition(this.typeNumber),t=0;t<o.length;t++)for(var e=0;e<o.length;e++){var n=o[t],r=o[e];if(null==this.modules[n][r])for(var i=-2;i<=2;i++)for(var u=-2;u<=2;u++)this.modules[n+i][r+u]=i==-2||i==2||u==-2||u==2||0==i&&0==u}},setupTypeNumber:function(o){for(var t=s.Util.getBCHTypeNumber(this.typeNumber),e=0;e<18;e++){var n=!o&&(1== (t>>e&1));this.modules[Math.floor(e/3)][e%3+this.moduleCount-8-3]=n}for(e=0;e<18;e++){n=!o&&(1== (t>>e&1));this.modules[e%3+this.moduleCount-8-3][Math.floor(e/3)]=n}},setupTypeInfo:function(o,t){for(var e=s.ErrorCorrectLevel.Q,n=s.Util.getBCHTypeInfo(e<<3|t),r=0;r<15;r++){var i=!o&&(1== (n>>r&1));r<6?this.modules[r][8]=i:r<8?this.modules[r+1][8]=i:this.modules[this.moduleCount-15+r][8]=i}for(r=0;r<15;r++){i=!o&&(1== (n>>r&1));r<8?this.modules[8][this.moduleCount-r-1]=i:r<9?this.modules[8][15-r-1+1]=i:this.modules[8][15-r-1]=i}this.modules[this.moduleCount-8][8]=!o},mapData:function(o,t){for(var e=-1,n=this.moduleCount-1,r=7,i=0,u=this.moduleCount-1;u>0;u-=2)for(6==u&&u--;;){for(var f=0;f<2;f++)null==this.modules[n][u-f]&&(i<o.length&&(this.modules[n][u-f]=1==(o[i]>>>r&1)),r--,-1==r&&(i++,r=7));if(n+=e,n<0||this.moduleCount<=n){n-=e,e=-e;break}}}},e.PAD0=236,e.PAD1=17,e.createData=function(o,t,r){for(var i=new i,u=0;u<r.length;u++){var f=r[u];i.put(4,4),i.put(f.getLength(),8),f.write(i)}for(var s=1;;s++){var a=new e(s,t);if(i.getLengthInBits()<=a.getMaxDataCount()*8)break}for(var c=a.getMaxDataCount()*8-i.getLengthInBits(),h=0;h<c;h++)i.put(0,1);for(;i.getLengthInBits()%8!=0;)i.put(0,1);for(var l=[],g=0;g<i.buffer.length;g++)l.push(i.buffer[g]);for(var d=a.getMaxDataCount()-l.length;d>0;d--)l.push(d%2?e.PAD0:e.PAD1);return s=a.createBytes(l),s},e.prototype.getMaxDataCount=function(){return e.getRSBlocks(this.typeNumber,this.errorCorrectLevel).reduce(function(o,t){return o+t.dataCount},0)},e.prototype.createBytes=function(o){for(var t=e.getRSBlocks(this.typeNumber,this.errorCorrectLevel),r=0,i=0;i<t.length;i++)r+=t[i].dataCount;for(var u=new Array(t.length),f=new Array(t.length),s=0;s<t.length;s++){var a=t[s].dataCount;u[s]=new Array(a);for(var c=0;c<a;c++)u[s][c]=o[c+i];i+=a;var h=t[s].totalCount-a;f[s]=e.getErrorCorrectPolynomial(h),u[s]=e.RSModulo(u[s],f[s])}for(var l=0,g=0;g<t.length;g++)l=Math.max(l,t[g].totalCount);for(var d=[],v=0;v<l;v++)for(g=0;g<t.length;g++){var m=t[g];v<m.dataCount&&d.push(o[v+m.dataCount*i/t.length|0])}for(v=0;v<l;v++)for(g=0;g<t.length;g++){m=t[g];v<m.totalCount-m.dataCount&&d.push(u[g][v])}return d},e.RSModulo=function(o,t){for(var e=o.slice(0),r=e.length-t.getLength()+1,i=0;i<r;i++){for(var u=e[i],f=0;f<t.getLength();f++)e[i+f]^=n.gexp(n.glog(t.getAt(f))+n.glog(u))}return e.slice(e.length-t.getLength()+1)},n.glog=function(o){if(o<1)throw new Error("glog("+o+")");return n.LOG_TABLE[o]},n.gexp=function(o){for(;o<0;)o+=255;for(;o>=256;)o-=255;return n.EXP_TABLE[o]},n.LOG_TABLE=new Array(256),n.EXP_TABLE=new Array(256);for(var a=1,c=0;c<256;c++)n.EXP_TABLE[c]=a,a<<=1,a>=256&&(a^=285),n.LOG_TABLE[n.EXP_TABLE[c]]=c;n.prototype={getAt:function(o){return this.buf[o]},getLength:function(){return this.buf.length}};var h={L:1,M:0,Q:3,H:2};s.ErrorCorrectLevel=h,s.Util={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34]],getPatternPosition:function(o){return this.PATTERN_POSITION_TABLE[o-1]||[]},getBCHTypeInfo:function(o){for(var t=o<<10;t>=1024;)t^=1335;return o<<10^t},getBCHTypeNumber:function(o){for(var t=o<<12;t>=4096;)t^=7973;return o<<12^t},getLostPoint:function(o){for(var t=o.getModuleCount(),e=0,n=0;n<t;n++)for(var r=0;r<t;r++){for(var i=0,u=o.isDark(n,r),f=-1;f<=1;f++)if(!(n+f<0||t<=n+f))for(var s=-1;s<=1;s++)r+s<0||t<=r+s||0==f&&0==s||(u==o.isDark(n+f,r+s)&&i++);i>5&&(e+=3+i-5)}return e}};var l=function(o,t){this._el=o,this._htOption=t};l.prototype.draw=function(o){var t=this._htOption,e=this._el,n=document.createElement("canvas");n.width=t.width,n.height=t.height;var r=n.getContext("2d"),i=o.getModuleCount(),u=t.width/i,f=t.height/i;r.fillStyle=t.colorLight,r.fillRect(0,0,t.width,t.height),r.fillStyle=t.colorDark;for(var s=0;s<i;s++)for(var a=0;a<i;a++)o.isDark(s,a)&&r.fillRect(Math.round(a*u),Math.round(s*f),Math.ceil(u),Math.ceil(f));e.innerHTML="",e.appendChild(n)};var g=function(o,t){this._el=o,this._htOption=t};g.prototype.draw=function(o){for(var t=this._htOption,e=this._el,n=o.getModuleCount(),r=t.width/n,i=t.height/n,u=[],f=0;f<n;f++){u.push("<tr>");for(var s=0;s<n;s++)u.push('<td style="width:'+r+"px;height:"+i+"px;background:"+(o.isDark(f,s)?t.colorDark:t.colorLight)+'"></td>');u.push("</tr>")}var a='<table style="border:0;border-collapse:collapse;background:'+t.colorLight+'">';a+=u.join("")+"</table>",e.innerHTML=a};var d=function(o,t){this._el=o,this._htOption={width:t.width||256,height:t.height||256,colorDark:t.colorDark||"#000000",colorLight:t.colorLight||"#ffffff",correctLevel:h.Q};this._oQRCode=null,this._oDrawing=null,this._htOption.useSVG?this._oDrawing=new g(o,this._htOption):this._oDrawing=new l(o,this._htOption),this.makeCode(t.text||"")};d.prototype.makeCode=function(o){this._oQRCode=new e(4,this._htOption.correctLevel),this._oQRCode.addData(o),this._oQRCode.make(),this._oDrawing.draw(this._oQRCode)};o.QRCode=d}(window);

const qrelem = document.getElementById('qrcode');
let qr = new QRCode(qrelem,{text:'https://example.com',width:512,height:512,colorDark:'#000000',colorLight:'#ffffff'});
document.getElementById('make').onclick = () => {
  const v = document.getElementById('url').value.trim();
  if(!v){alert('URLを入力してください');return;}
  qr.makeCode(v);
};
document.getElementById('download').onclick = () => {
  const canvas = qrelem.querySelector('canvas');
  if(!canvas){alert('先に生成してください');return;}
  const link = document.createElement('a');
  link.download = 'qr.png';
  link.href = canvas.toDataURL('image/png');
  link.click();
};
</script>
</body>
</html>
